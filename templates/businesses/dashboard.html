{% extends 'businesses/base_dashboard.html' %}
{% block dashboard_content %}
    <h1 style="font-size: 2rem; margin-bottom: 20px;">Hola, {{ user.first_name }}</h1>

    {% if not user.is_verified_payment %}
    <div style="background: linear-gradient(45deg, #b33939, #000); border: 1px solid #ff4d4d; padding: 20px; border-radius: 10px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h3 style="color: #ff4d4d; margin-bottom: 5px;">âš ï¸ Cuenta no verificada</h3>
            {% if payment_expired %}
                <p>Tu tiempo de prueba ha expirado. El sistema limitarÃ¡ tu acceso pronto.</p>
            {% else %}
                <p>Tienes <strong style="color: white; font-size: 1.2rem;">{{ hours_remaining }} horas</strong> para activar tu Ecosistema.</p>
            {% endif %}
        </div>
        <a href="https://wa.me/573228317702?text=Hola%20quiero%20activar%20mi%20cuenta%20de%20dueÃ±o%20ID:%20{{ user.username }}" target="_blank" class="btn btn-primary">Pagar Mensualidad</a>
    </div>
    {% endif %}

    <h2 style="color: #d4af37; margin-bottom: 20px;">ğŸ›ï¸ Solicitudes de Reserva</h2>
    <div style="display: grid; gap: 20px;">
        {% for cita in pending_appointments %}
        <div style="background: #111; border-left: 4px solid #ffcc00; padding: 20px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
            <div>
                <h3 style="font-size: 1.2rem; margin-bottom: 5px;">{{ cita.service.name }} (${{ cita.total_price }})</h3>
                <p style="color: #ccc;">Cliente: <strong>{{ cita.client.first_name }} {{ cita.client.last_name }}</strong></p>
                <p style="color: #888;">Abono esperado: <strong style="color: #d4af37;">${{ cita.deposit_amount }}</strong></p>
            </div>
            
            <div style="display: flex; align-items: center; gap: 15px;">
                <span style="color: #ff4d4d; font-family: monospace;">â³ Esperando pago...</span>
                <form action="{% url 'booking:verify_payment' cita.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary" style="background: #4cd137; border-color: #4cd137; color: black; font-weight: bold;">
                        âœ… Verificar Pago
                    </button>
                </form>
            </div>
        </div>
        {% empty %}
        <p style="color: #666;">No hay solicitudes pendientes.</p>
        {% endfor %}
    </div>
{% endblock %}
