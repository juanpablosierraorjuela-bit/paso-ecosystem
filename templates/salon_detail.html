{% extends 'base.html' %}

{% block content %}
<div style="max-width: 1000px; margin: 0 auto; padding: 40px 20px;">
    
    <div class="glass-panel" style="margin-top: 0; display: flex; align-items: center; gap: 30px; flex-wrap: wrap;">
        <div class="salon-avatar" style="width: 100px; height: 100px; font-size: 2.5rem;">
            {% if salon.logo %}
                <img src="{{ salon.logo.url }}" style="width:100%; height:100%; border-radius:18px; object-fit:cover;">
            {% else %}
                {{ salon.name|slice:":1"|upper }}
            {% endif %}
        </div>
        <div style="flex: 1;">
            <h1 style="font-weight: 800; font-size: 2.5rem; margin: 0 0 10px;">{{ salon.name }}</h1>
            <p style="color: var(--secondary); font-size: 1.1rem; margin: 0;">
                <i class="fas fa-map-marker-alt"></i> {{ salon.address }}, {{ salon.city }}
            </p>
        </div>
        <div class="status-pill {% if salon.is_open %}open{% else %}closed{% endif %}" style="font-size: 1rem; padding: 10px 20px;">
            {% if salon.is_open %}ABIERTO AHORA{% else %}CERRADO{% endif %}
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
        
        <div>
            <h2 style="font-weight: 800; margin-bottom: 20px; font-size: 1.5rem;">Servicios Disponibles</h2>
            <div class="salon-card" style="padding: 0;">
                {% for service in salon.services.all %}
                <div class="service-item">
                    <div>
                        <h4 style="margin: 0; font-weight: 700;">{{ service.name }}</h4>
                        <span style="font-size: 0.85rem; color: var(--secondary);">‚è± {{ service.duration_minutes }} min</span>
                        {% if service.description %}
                            <p style="font-size: 0.85rem; color: #94a3b8; margin: 5px 0 0;">{{ service.description }}</p>
                        {% endif %}
                    </div>
                    <div style="text-align: right;">
                        <div class="price-tag">${{ service.price }}</div>
                        <a href="?service={{ service.id }}" class="btn-access" style="padding: 6px 15px; font-size: 0.8rem; margin-top: 8px; display: inline-block;">
                            Seleccionar
                        </a>
                    </div>
                </div>
                {% empty %}
                    <p style="padding: 30px; text-align: center; color: var(--secondary);">Este sal√≥n a√∫n no tiene servicios publicados.</p>
                {% endfor %}
            </div>
        </div>

        <div style="position: sticky; top: 100px; height: fit-content;">
            <div class="salon-card" style="border: 2px solid var(--primary);">
                <h3 style="margin-top: 0; font-weight: 800;">üìÖ Reservar Cita</h3>
                
                {% if selected_service %}
                    <div style="background: #f1f5f9; padding: 15px; border-radius: 12px; margin-bottom: 20px;">
                        <span style="font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; color: var(--secondary);">Servicio seleccionado:</span>
                        <div style="font-weight: 700; font-size: 1.1rem;">{{ selected_service.name }}</div>
                        <div style="color: var(--accent); font-weight: 700;">${{ selected_service.price }}</div>
                    </div>

                    <form method="post">
                        {% csrf_token %}
                        
                        <label style="font-weight: 600; font-size: 0.9rem; margin-bottom: 5px; display: block;">¬øQui√©n te atiende?</label>
                        {{ form.employee }}
                        
                        <label style="font-weight: 600; font-size: 0.9rem; margin-bottom: 5px; display: block;">Tus Datos</label>
                        {{ form.customer_name }}
                        {{ form.customer_phone }}
                        
                        <label style="font-weight: 600; font-size: 0.9rem; margin-bottom: 5px; display: block;">¬øCu√°ndo?</label>
                        {{ form.start_time }}
                        
                        <button type="submit" class="btn-access" style="width: 100%; margin-top: 10px; font-size: 1.1rem; padding: 15px;">
                            Confirmar Reserva
                        </button>
                    </form>
                {% else %}
                    <p style="color: var(--secondary); line-height: 1.6;">
                        üëà Por favor, selecciona un servicio del men√∫ de la izquierda para comenzar tu reserva.
                    </p>
                    <div style="text-align: center; font-size: 3rem; opacity: 0.2; margin-top: 20px;">üëÜ</div>
                {% endif %}
            </div>
        </div>

    </div>
</div>
{% endblock %}